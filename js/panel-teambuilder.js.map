{"version":3,"file":"panel-teambuilder.js","names":["TeambuilderRoom","_PSRoom","_inheritsLoose","_this","_len","arguments","length","args","Array","_key","call","apply","concat","DEFAULT_FORMAT","curFolder","curFolderKeep","_proto","prototype","handleMessage","line","startsWith","spaceIndex","indexOf","cmd","slice","target","PS","teams","push","createTeam","unshift","update","team","byKey","undelete","alert","copyFrom","name","format","folder","packedTeam","iconCache","key","endsWith","list","PSRoom","TeambuilderPanel","_PSRoomPanel","_this2","_len2","_key2","selectFolder","e","room","props","elem","className","getAttribute","parentElement","preventDefault","stopImmediatePropagation","forceUpdate","_proto2","renderFolderList","folderTable","folders","_i2","_PS$teams$list2","PSUtils","sortBy","parseInt","charAt","renderedFormatFolders","preact","h","TeamFolder","cur","value","renderedFolders","gen","_i4","newGen","folderOpenIcon","onClick","render","deletedTeams","undeleteIndex","splice","filterFolder","filterFormat","filter","PSPanelWrapper","style","map","TeamBox","PSRoomPanel","roomTypes","Model","Component","title"],"sources":["../src/panel-teambuilder.tsx"],"sourcesContent":["/**\n * Teambuilder panel\n *\n * @author Guangcong Luo <guangcongluo@gmail.com>\n * @license AGPLv3\n */\n\nclass TeambuilderRoom extends PSRoom {\n\treadonly DEFAULT_FORMAT = 'gen8' as ID;\n\n\t/**\n\t * - `\"\"` - all\n\t * - `\"gen[NUMBER][ID]\"` - format folder\n\t * - `\"gen[NUMBER]\"` - uncategorized gen folder\n\t * - `\"[ID]/\"` - folder\n\t * - `\"/\"` - not in folder\n\t */\n\tcurFolder = '';\n\tcurFolderKeep = '';\n\n\t/**\n\t * @return true to prevent line from being sent to server\n\t */\n\thandleMessage(line: string) {\n\t\tif (!line.startsWith('/') || line.startsWith('//')) return false;\n\t\tconst spaceIndex = line.indexOf(' ');\n\t\tconst cmd = spaceIndex >= 0 ? line.slice(1, spaceIndex) : line.slice(1);\n\t\tconst target = spaceIndex >= 0 ? line.slice(spaceIndex + 1) : '';\n\t\tswitch (cmd) {\n\t\tcase 'newteam': {\n\t\t\tif (target === 'bottom') {\n\t\t\t\tPS.teams.push(this.createTeam());\n\t\t\t} else {\n\t\t\t\tPS.teams.unshift(this.createTeam());\n\t\t\t}\n\t\t\tthis.update(null);\n\t\t\treturn true;\n\t\t} case 'deleteteam': {\n\t\t\tconst team = PS.teams.byKey[target];\n\t\t\tif (team) PS.teams.delete(team);\n\t\t\tthis.update(null);\n\t\t\treturn true;\n\t\t} case 'undeleteteam': {\n\t\t\tPS.teams.undelete();\n\t\t\tthis.update(null);\n\t\t\treturn true;\n\t\t}}\n\n\t\t// unrecognized command\n\t\talert(`Unrecognized command: ${line}`);\n\t\treturn true;\n\t}\n\n\tcreateTeam(copyFrom?: Team): Team {\n\t\tif (copyFrom) {\n\t\t\treturn {\n\t\t\t\tname: `Copy of ${copyFrom.name}`,\n\t\t\t\tformat: copyFrom.format,\n\t\t\t\tfolder: copyFrom.folder,\n\t\t\t\tpackedTeam: copyFrom.packedTeam,\n\t\t\t\ticonCache: null,\n\t\t\t\tkey: '',\n\t\t\t};\n\t\t} else {\n\t\t\tconst format = this.curFolder && !this.curFolder.endsWith('/') ? this.curFolder as ID : this.DEFAULT_FORMAT;\n\t\t\tconst folder = this.curFolder.endsWith('/') ? this.curFolder.slice(0, -1) : '';\n\t\t\treturn {\n\t\t\t\tname: `Untitled ${PS.teams.list.length + 1}`,\n\t\t\t\tformat,\n\t\t\t\tfolder,\n\t\t\t\tpackedTeam: '',\n\t\t\t\ticonCache: null,\n\t\t\t\tkey: '',\n\t\t\t};\n\t\t}\n\t}\n}\n\nclass TeambuilderPanel extends PSRoomPanel<TeambuilderRoom> {\n\tselectFolder = (e: MouseEvent) => {\n\t\tconst room = this.props.room;\n\t\tlet elem = e.target as HTMLElement | null;\n\t\tlet folder: string | null = null;\n\t\twhile (elem) {\n\t\t\tif (elem.className === 'selectFolder') {\n\t\t\t\tfolder = elem.getAttribute('data-value') || '';\n\t\t\t\tbreak;\n\t\t\t} else if (elem.className === 'folderlist') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telem = elem.parentElement;\n\t\t}\n\t\tif (folder === null) return;\n\t\troom.curFolderKeep = folder;\n\t\troom.curFolder = folder;\n\t\te.preventDefault();\n\t\te.stopImmediatePropagation();\n\t\tthis.forceUpdate();\n\t};\n\trenderFolderList() {\n\t\tconst room = this.props.room;\n\t\t// The folder list isn't actually saved anywhere:\n\t\t// it's regenerated anew from the team list every time.\n\n\t\t// (This is why folders you create will automatically disappear\n\t\t// if you leave them without adding anything to them.)\n\n\t\tconst folderTable: {[folder: string]: 1 | undefined} = {'': 1};\n\t\tconst folders: string[] = [];\n\t\tfor (const team of PS.teams.list) {\n\t\t\tconst folder = team.folder;\n\t\t\tif (folder && !(`${folder}/` in folderTable)) {\n\t\t\t\tfolders.push(`${folder}/`);\n\t\t\t\tfolderTable[`${folder}/`] = 1;\n\t\t\t\tif (!('/' in folderTable)) {\n\t\t\t\t\tfolders.push('/');\n\t\t\t\t\tfolderTable['/'] = 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst format = team.format || room.DEFAULT_FORMAT;\n\t\t\tif (!(format in folderTable)) {\n\t\t\t\tfolders.push(format);\n\t\t\t\tfolderTable[format] = 1;\n\t\t\t}\n\t\t}\n\t\tif (!(room.curFolderKeep in folderTable)) {\n\t\t\tfolderTable[room.curFolderKeep] = 1;\n\t\t\tfolders.push(room.curFolderKeep);\n\t\t}\n\t\tif (!(room.curFolder in folderTable)) {\n\t\t\tfolderTable[room.curFolder] = 1;\n\t\t\tfolders.push(room.curFolder);\n\t\t}\n\n\t\tPSUtils.sortBy(folders, folder => [\n\t\t\tfolder.endsWith('/') ? 10 : -parseInt(folder.charAt(3), 10),\n\t\t\tfolder,\n\t\t]);\n\n\t\tlet renderedFormatFolders = [\n\t\t\t<div class=\"foldersep\"></div>,\n\t\t\t<TeamFolder cur={false} value=\"+\">\n\t\t\t\t<i class=\"fa fa-plus\"></i><em>(add format folder)</em>\n\t\t\t</TeamFolder>,\n\t\t];\n\n\t\tlet renderedFolders: preact.ComponentChild[] = [];\n\n\t\tlet gen = -1;\n\t\tfor (let format of folders) {\n\t\t\tconst newGen = format.endsWith('/') ? 0 : parseInt(format.charAt(3), 10);\n\t\t\tif (gen !== newGen) {\n\t\t\t\tgen = newGen;\n\t\t\t\tif (gen === 0) {\n\t\t\t\t\trenderedFolders.push(...renderedFormatFolders);\n\t\t\t\t\trenderedFormatFolders = [];\n\t\t\t\t\trenderedFolders.push(<div class=\"foldersep\"></div>);\n\t\t\t\t\trenderedFolders.push(<div class=\"folder\"><h3>Folders</h3></div>);\n\t\t\t\t} else {\n\t\t\t\t\trenderedFolders.push(<div class=\"folder\"><h3>Gen {gen}</h3></div>);\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst folderOpenIcon = room.curFolder === format ? 'fa-folder-open' : 'fa-folder';\n\t\t\tif (gen === 0) {\n\t\t\t\trenderedFolders.push(<TeamFolder cur={room.curFolder === format} value={format}>\n\t\t\t\t\t<i class={\n\t\t\t\t\t\t`fa ${folderOpenIcon}${format === '/' ? '-o' : ''}`\n\t\t\t\t\t}></i>\n\t\t\t\t\t{format.slice(0, -1) || '(uncategorized)'}\n\t\t\t\t</TeamFolder>);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\trenderedFolders.push(<TeamFolder cur={room.curFolder === format} value={format}>\n\t\t\t\t<i class={`fa ${folderOpenIcon}-o`}></i>\n\t\t\t\t{format.slice(4) || '(uncategorized)'}\n\t\t\t</TeamFolder>);\n\t\t}\n\t\trenderedFolders.push(...renderedFormatFolders);\n\n\t\treturn <div class=\"folderlist\" onClick={this.selectFolder}>\n\t\t\t<div class=\"folderlistbefore\"></div>\n\n\t\t\t<TeamFolder cur={!room.curFolder} value=\"\">\n\t\t\t\t<em>(all)</em>\n\t\t\t</TeamFolder>\n\t\t\t{renderedFolders}\n\t\t\t<div class=\"foldersep\"></div>\n\t\t\t<TeamFolder cur={false} value=\"++\">\n\t\t\t\t<i class=\"fa fa-plus\"></i><em>(add folder)</em>\n\t\t\t</TeamFolder>\n\n\t\t\t<div class=\"folderlistafter\"></div>\n\t\t</div>;\n\t}\n\n\trender() {\n\t\tconst room = this.props.room;\n\t\tlet teams: (Team | null)[] = PS.teams.list.slice();\n\n\t\tif (PS.teams.deletedTeams.length) {\n\t\t\tconst undeleteIndex = PS.teams.deletedTeams[PS.teams.deletedTeams.length - 1][1];\n\t\t\tteams.splice(undeleteIndex, 0, null);\n\t\t}\n\n\t\tlet filterFolder: string | null = null;\n\t\tlet filterFormat: string | null = null;\n\t\tif (room.curFolder) {\n\t\t\tif (room.curFolder.slice(-1) === '/') {\n\t\t\t\tfilterFolder = room.curFolder.slice(0, -1);\n\t\t\t\tteams = teams.filter(team => !team || team.folder === filterFolder);\n\t\t\t} else {\n\t\t\t\tfilterFormat = room.curFolder;\n\t\t\t\tteams = teams.filter(team => !team || team.format === filterFormat);\n\t\t\t}\n\t\t}\n\n\t\treturn <PSPanelWrapper room={room}>\n\t\t\t<div class=\"folderpane\">\n\t\t\t\t{this.renderFolderList()}\n\t\t\t</div>\n\t\t\t<div class=\"teampane\">\n\t\t\t\t{filterFolder ?\n\t\t\t\t\t<h2>\n\t\t\t\t\t\t<i class=\"fa fa-folder-open\"></i> {filterFolder} {}\n\t\t\t\t\t\t<button class=\"button small\" style=\"margin-left:5px\" name=\"renameFolder\">\n\t\t\t\t\t\t\t<i class=\"fa fa-pencil\"></i> Rename\n\t\t\t\t\t\t</button> {}\n\t\t\t\t\t\t<button class=\"button small\" style=\"margin-left:5px\" name=\"promptDeleteFolder\">\n\t\t\t\t\t\t\t<i class=\"fa fa-times\"></i> Remove\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</h2>\n\t\t\t\t: filterFolder === '' ?\n\t\t\t\t\t<h2><i class=\"fa fa-folder-open-o\"></i> Teams not in any folders</h2>\n\t\t\t\t: filterFormat ?\n\t\t\t\t\t<h2><i class=\"fa fa-folder-open-o\"></i> {filterFormat} <small>({teams.length})</small></h2>\n\t\t\t\t:\n\t\t\t\t\t<h2>All Teams <small>({teams.length})</small></h2>\n\t\t\t\t}\n\t\t\t\t<p>\n\t\t\t\t\t<button name=\"cmd\" value=\"/newteam\" class=\"button big\"><i class=\"fa fa-plus-circle\"></i> New Team</button>\n\t\t\t\t</p>\n\t\t\t\t<ul class=\"teamlist\">\n\t\t\t\t\t{teams.map(team => team ? (\n\t\t\t\t\t\t<li key={team.key}>\n\t\t\t\t\t\t\t<TeamBox team={team} /> {}\n\t\t\t\t\t\t\t<button name=\"cmd\" value={`/deleteteam ${team.key}`}><i class=\"fa fa-trash\"></i> Delete</button>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<li key=\"undelete\">\n\t\t\t\t\t\t\t<button name=\"cmd\" value={`/undeleteteam`}><i class=\"fa fa-undo\"></i> Undo delete</button>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t))}\n\t\t\t\t</ul>\n\t\t\t\t<p>\n\t\t\t\t\t<button name=\"cmd\" value=\"/newteam bottom\" class=\"button\"><i class=\"fa fa-plus-circle\"></i> New Team</button>\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t</PSPanelWrapper>;\n\t}\n}\n\nPS.roomTypes['teambuilder'] = {\n\tModel: TeambuilderRoom,\n\tComponent: TeambuilderPanel,\n\ttitle: \"Teambuilder\",\n};\n"],"mappings":"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"}