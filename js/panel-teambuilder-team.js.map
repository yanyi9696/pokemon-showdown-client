{"version":3,"file":"panel-teambuilder-team.js","names":["TeamRoom","_PSRoom","_inheritsLoose","_this","_len","arguments","length","args","Array","_key","call","apply","concat","team","PSRoom","TeamTextbox","_preact$Component","_this2","_len2","_key2","setInfo","sets","textbox","heightTester","activeType","activeOffsetY","activeSetIndex","search","DexSearch","input","update","select","closeMenu","forceUpdate","focus","cursorOnly","style","width","offsetWidth","value","index","setIndex","selectionStart","selectionEnd","parseState","nlIndex","indexOf","line","slice","trim","bottomY","getYAt","atIndex","species","endsWith","parenIndex","lastIndexOf","push","selectionEndCutoff","lcLine","toLowerCase","startsWith","setType","find","window","height","save","_proto","prototype","scrollHeight","PSTeambuilder","importTeam","props","packedTeam","packTeam","iconCache","PS","teams","componentDidMount","base","getElementsByClassName","unpackTeam","exportedTeam","exportTeam","componentWillUnmount","render","_this3","preact","h","onInput","onSelect","onClick","onKeyUp","tabIndex","map","info","i","prevOffset","num","Dex","getPokemonIconNum","toID","top","Math","floor","left","iconStyle","resourcePrefix","PSSearchResults","Component","TeamPanel","_PSRoomPanel","_this4","_len3","_key3","rename","e","currentTarget","room","name","_proto2","byKey","id","PSPanelWrapper","scrollable","type","onChange","PSRoomPanel","roomTypes","Model","title","updateRoomTypes"],"sources":["../src/panel-teambuilder-team.tsx"],"sourcesContent":["/**\n * Teambuilder team panel\n *\n * @author Guangcong Luo <guangcongluo@gmail.com>\n * @license AGPLv3\n */\n\nclass TeamRoom extends PSRoom {\n\tteam: Team | null = null;\n}\n\nclass TeamTextbox extends preact.Component<{team: Team}> {\n\tsetInfo: {\n\t\tspecies: string,\n\t\tbottomY: number,\n\t}[] = [];\n\tsets: PokemonSet[] = [];\n\ttextbox: HTMLTextAreaElement = null!;\n\theightTester: HTMLTextAreaElement = null!;\n\tactiveType: 'pokemon' | 'move' | 'item' | 'ability' | '' = '';\n\tactiveOffsetY = -1;\n\tactiveSetIndex = -1;\n\tsearch = new DexSearch();\n\tgetYAt(index: number, value: string) {\n\t\tif (index < 0) return 10;\n\t\tthis.heightTester.value = value.slice(0, index);\n\t\treturn this.heightTester.scrollHeight;\n\t}\n\tinput = () => this.update();\n\tselect = () => this.update(true);\n\tcloseMenu = () => {\n\t\tthis.activeType = '';\n\t\tthis.forceUpdate();\n\t\tthis.textbox.focus();\n\t};\n\tupdate = (cursorOnly?: boolean) => {\n\t\tconst textbox = this.textbox;\n\t\tthis.heightTester.style.width = `${textbox.offsetWidth}px`;\n\t\tconst value = textbox.value;\n\n\t\tlet index = 0;\n\t\tlet setIndex = -1;\n\t\tif (!cursorOnly) this.setInfo = [];\n\t\tthis.activeOffsetY = -1;\n\t\tthis.activeSetIndex = -1;\n\t\tthis.activeType = '';\n\n\t\tconst selectionStart = textbox.selectionStart || 0;\n\t\tconst selectionEnd = textbox.selectionEnd || 0;\n\n\t\t/** 0 = set top, 1 = set middle */\n\t\tlet parseState: 0 | 1 = 0;\n\t\twhile (index < value.length) {\n\t\t\tlet nlIndex = value.indexOf('\\n', index);\n\t\t\tif (nlIndex < 0) nlIndex = value.length;\n\t\t\tconst line = value.slice(index, nlIndex).trim();\n\n\t\t\tif (!line) {\n\t\t\t\tparseState = 0;\n\t\t\t\tindex = nlIndex + 1;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (parseState === 0 && index && !cursorOnly) {\n\t\t\t\tthis.setInfo[this.setInfo.length - 1].bottomY = this.getYAt(index - 1, value);\n\t\t\t}\n\n\t\t\tif (parseState === 0) {\n\t\t\t\tif (!cursorOnly) {\n\t\t\t\t\tconst atIndex = line.indexOf('@');\n\t\t\t\t\tlet species = atIndex >= 0 ? line.slice(0, atIndex).trim() : line;\n\t\t\t\t\tif (species.endsWith(' (M)') || species.endsWith(' (F)')) {\n\t\t\t\t\t\tspecies = species.slice(0, -4);\n\t\t\t\t\t}\n\t\t\t\t\tif (species.endsWith(')')) {\n\t\t\t\t\t\tconst parenIndex = species.lastIndexOf(' (');\n\t\t\t\t\t\tif (parenIndex >= 0) {\n\t\t\t\t\t\t\tspecies = species.slice(parenIndex + 2, -1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.setInfo.push({\n\t\t\t\t\t\tspecies,\n\t\t\t\t\t\tbottomY: -1,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tparseState = 1;\n\t\t\t\tsetIndex++;\n\t\t\t}\n\n\t\t\tconst selectionEndCutoff = (selectionStart === selectionEnd ? nlIndex : nlIndex + 1);\n\t\t\tif (index <= selectionStart && selectionEnd <= selectionEndCutoff) {\n\t\t\t\t// both ends within range\n\t\t\t\tthis.activeOffsetY = this.getYAt(index - 1, value);\n\t\t\t\tthis.activeSetIndex = setIndex;\n\n\t\t\t\tconst lcLine = line.toLowerCase().trim();\n\t\t\t\tif (lcLine.startsWith('ability:')) {\n\t\t\t\t\tthis.activeType = 'ability';\n\t\t\t\t} else if (lcLine.startsWith('-')) {\n\t\t\t\t\tthis.activeType = 'move';\n\t\t\t\t} else if (\n\t\t\t\t\t!lcLine || lcLine.startsWith('ivs:') || lcLine.startsWith('evs:') ||\n\t\t\t\t\tlcLine.startsWith('level:') || lcLine.startsWith('gender:') ||\n\t\t\t\t\tlcLine.endsWith(' nature') || lcLine.startsWith('shiny:')\n\t\t\t\t) {\n\t\t\t\t\t// leave activeType blank\n\t\t\t\t} else {\n\t\t\t\t\tthis.activeType = 'pokemon';\n\t\t\t\t\tconst atIndex = line.indexOf('@');\n\t\t\t\t\tif (atIndex >= 0 && selectionStart > index + atIndex) {\n\t\t\t\t\t\tthis.activeType = 'item';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.search.setType(this.activeType, 'gen8ou' as ID, this.sets[setIndex]);\n\t\t\t\tthis.search.find('');\n\t\t\t\twindow.search = this.search;\n\t\t\t}\n\n\t\t\tindex = nlIndex + 1;\n\t\t}\n\t\tif (!cursorOnly) {\n\t\t\tconst bottomY = this.getYAt(value.length, value);\n\t\t\tif (this.setInfo.length) {\n\t\t\t\tthis.setInfo[this.setInfo.length - 1].bottomY = bottomY;\n\t\t\t}\n\n\t\t\ttextbox.style.height = `${bottomY + 100}px`;\n\t\t\tthis.save();\n\t\t}\n\t\tthis.forceUpdate();\n\t};\n\tsave() {\n\t\tconst sets = PSTeambuilder.importTeam(this.textbox.value);\n\t\tthis.props.team.packedTeam = PSTeambuilder.packTeam(sets);\n\t\tthis.props.team.iconCache = null;\n\t\tPS.teams.save();\n\t}\n\tcomponentDidMount() {\n\t\tthis.textbox = this.base!.getElementsByClassName('teamtextbox')[0] as HTMLTextAreaElement;\n\t\tthis.heightTester = this.base!.getElementsByClassName('heighttester')[0] as HTMLTextAreaElement;\n\n\t\tthis.sets = PSTeambuilder.unpackTeam(this.props.team.packedTeam);\n\t\tconst exportedTeam = PSTeambuilder.exportTeam(this.sets);\n\t\tthis.textbox.value = exportedTeam;\n\t\tthis.update();\n\t}\n\tcomponentWillUnmount() {\n\t\tthis.textbox = null!;\n\t\tthis.heightTester = null!;\n\t}\n\trender() {\n\t\treturn <div class=\"teameditor\">\n\t\t\t<textarea class=\"textbox teamtextbox\" onInput={this.input} onSelect={this.select} onClick={this.select} onKeyUp={this.select} />\n\t\t\t<textarea\n\t\t\t\tclass=\"textbox teamtextbox heighttester\" style=\"visibility:hidden\" tabIndex={-1} aria-hidden={true}\n\t\t\t/>\n\t\t\t<div class=\"teamoverlays\">\n\t\t\t\t{this.setInfo.slice(0, -1).map(info =>\n\t\t\t\t\t<hr style={`top:${info.bottomY - 18}px`} />\n\t\t\t\t)}\n\t\t\t\t{this.setInfo.map((info, i) => {\n\t\t\t\t\tif (!info.species) return null;\n\t\t\t\t\tconst prevOffset = i === 0 ? 8 : this.setInfo[i - 1].bottomY;\n\t\t\t\t\tconst species = info.species;\n\t\t\t\t\tconst num = Dex.getPokemonIconNum(toID(species));\n\t\t\t\t\tif (!num) return null;\n\n\t\t\t\t\tconst top = Math.floor(num / 12) * 30;\n\t\t\t\t\tconst left = (num % 12) * 40;\n\t\t\t\t\tconst iconStyle = `background:transparent url(${Dex.resourcePrefix}sprites/pokemonicons-sheet.png) no-repeat scroll -${left}px -${top}px`;\n\n\t\t\t\t\treturn <span class=\"picon\" style={\n\t\t\t\t\t\t`top:${prevOffset + 1}px;left:50px;position:absolute;${iconStyle}`\n\t\t\t\t\t}></span>;\n\t\t\t\t})}\n\t\t\t\t{this.activeOffsetY >= 0 &&\n\t\t\t\t\t<div class=\"teaminnertextbox\" style={{top: this.activeOffsetY - 1}}></div>\n\t\t\t\t}\n\t\t\t</div>\n\t\t\t{this.activeType && <div class=\"searchresults\" style={{top: this.activeSetIndex >= 0 ? this.setInfo[this.activeSetIndex].bottomY - 12 : 0}}>\n\t\t\t\t<button class=\"button closesearch\" onClick={this.closeMenu}><i class=\"fa fa-times\"></i> Close</button>\n\t\t\t\t<PSSearchResults search={this.search} />\n\t\t\t</div>}\n\t\t</div>;\n\t}\n}\n\nclass TeamPanel extends PSRoomPanel<TeamRoom> {\n\trename = (e: Event) => {\n\t\tconst textbox = e.currentTarget as HTMLInputElement;\n\t\tconst room = this.props.room;\n\n\t\troom.team!.name = textbox.value.trim();\n\t\tPS.teams.save();\n\t};\n\trender() {\n\t\tconst room = this.props.room;\n\t\tconst team = PS.teams.byKey[room.id.slice(5)];\n\t\tif (!team) {\n\t\t\treturn <PSPanelWrapper room={room}>\n\t\t\t\t<button class=\"button\" data-href=\"teambuilder\" data-target=\"replace\">\n\t\t\t\t\t<i class=\"fa fa-chevron-left\"></i> List\n\t\t\t\t</button>\n\t\t\t\t<p class=\"error\">\n\t\t\t\t\tTeam doesn't exist\n\t\t\t\t</p>\n\t\t\t</PSPanelWrapper>;\n\t\t}\n\n\t\tif (!room.team) room.team = team;\n\t\treturn <PSPanelWrapper room={room} scrollable>\n\t\t\t<div class=\"pad\">\n\t\t\t\t<button class=\"button\" data-href=\"teambuilder\" data-target=\"replace\">\n\t\t\t\t\t<i class=\"fa fa-chevron-left\"></i> List\n\t\t\t\t</button>\n\t\t\t\t<label class=\"label teamname\">\n\t\t\t\t\tTeam name:\n\t\t\t\t\t<input class=\"textbox\" type=\"text\" value={team.name} onInput={this.rename} onChange={this.rename} onKeyUp={this.rename} />\n\t\t\t\t</label>\n\t\t\t\t<TeamTextbox team={team} />\n\t\t\t</div>\n\t\t</PSPanelWrapper>;\n\t}\n}\n\nPS.roomTypes['team'] = {\n\tModel: TeamRoom,\n\tComponent: TeamPanel,\n\ttitle: \"Team\",\n};\nPS.updateRoomTypes();\n"],"mappings":"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"}