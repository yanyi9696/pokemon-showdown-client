{"version":3,"file":"panel-rooms.js","names":["RoomsRoom","_PSRoom","_inheritsLoose","options","_this","call","classType","PS","send","PSRoom","RoomsPanel","_PSRoomPanel","_this2","_len","arguments","length","args","Array","_key","apply","concat","hidden","search","lastKeyCode","hide","rightRoom","room","leftRoom","forceUpdate","update","changeSearch","e","target","currentTarget","selectionStart","selectionEnd","value","keyDownSearch","keyCode","arrowIndex","indexOf","slice","test","toID","preventDefault","stopImmediatePropagation","join","_proto","prototype","componentDidMount","subscriptions","push","user","subscribe","named","runSearch","searchid","exactMatch","rooms","mainmenu","roomsCache","roomList","chat","_i2","_roomList2","subRooms","_i4","_room$subRooms2","title","desc","start","filter","titleid","startsWith","replace","includes","abbr","toLowerCase","autoFill","firstTitle","firstTitleOffset","autoFillValue","oldSearch","searchElem","base","querySelector","setSelectionRange","focus","render","isVisible","props","preact","h","PSPanelWrapper","scrollable","renderRoomList","style","onClick","userCount","battleCount","type","name","placeholder","onInput","onKeyDown","isOffline","undefined","sortedRooms","sort","a","b","map","roomInfo","href","roomName","i","PSRoomPanel","roomTypes","Model","Component","updateRoomTypes"],"sources":["../src/panel-rooms.tsx"],"sourcesContent":["/**\n * Room-list panel (default right-panel)\n *\n * @author Guangcong Luo <guangcongluo@gmail.com>\n * @license AGPLv3\n */\n\nclass RoomsRoom extends PSRoom {\n\treadonly classType: string = 'rooms';\n\tconstructor(options: RoomOptions) {\n\t\tsuper(options);\n\t\tPS.send(`|/cmd rooms`);\n\t}\n}\n\nclass RoomsPanel extends PSRoomPanel {\n\thidden = false;\n\tsearch = '';\n\tlastKeyCode = 0;\n\tcomponentDidMount() {\n\t\tsuper.componentDidMount();\n\t\tthis.subscriptions.push(PS.user.subscribe(() => {\n\t\t\tif (PS.user.named) PS.send(`|/cmd rooms`);\n\t\t}));\n\t}\n\thide = () => {\n\t\tthis.hidden = true;\n\t\tPS.rightRoom = null;\n\t\tPS.room = PS.leftRoom;\n\t\tthis.forceUpdate();\n\t\tPS.update();\n\t};\n\tchangeSearch = (e: Event) => {\n\t\tconst target = (e.currentTarget as HTMLInputElement);\n\t\tif (target.selectionStart !== target.selectionEnd) return;\n\t\tthis.search = target.value;\n\t\tthis.forceUpdate();\n\t};\n\tkeyDownSearch = (e: KeyboardEvent) => {\n\t\tthis.lastKeyCode = e.keyCode;\n\t\tif (e.keyCode === 13) {\n\t\t\tconst target = (e.currentTarget as HTMLInputElement);\n\t\t\tlet value = target.value;\n\t\t\tconst arrowIndex = value.indexOf(' \\u21d2 ');\n\t\t\tif (arrowIndex >= 0) value = value.slice(arrowIndex + 3);\n\t\t\tif (!/^[a-z0-9-]$/.test(value)) value = toID(value);\n\n\t\t\te.preventDefault();\n\t\t\te.stopImmediatePropagation();\n\t\t\ttarget.value = '';\n\n\t\t\tPS.join(value as RoomID);\n\t\t}\n\t};\n\trunSearch() {\n\t\tconst searchid = toID(this.search);\n\t\tlet exactMatch = false;\n\n\t\tconst rooms = PS.mainmenu.roomsCache;\n\t\tlet roomList = [...(rooms.chat || [])];\n\t\tfor (const room of roomList) {\n\t\t\tif (!room.subRooms) continue;\n\t\t\tfor (const title of room.subRooms) {\n\t\t\t\troomList.push({\n\t\t\t\t\ttitle,\n\t\t\t\t\tdesc: `Subroom of ${room.title}`,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tlet start = roomList.filter(room => {\n\t\t\tconst titleid = toID(room.title);\n\t\t\tif (titleid === searchid) exactMatch = true;\n\t\t\treturn titleid.startsWith(searchid) ||\n\t\t\t\ttoID(room.title.replace(/^The /, '')).startsWith(searchid);\n\t\t});\n\t\troomList = roomList.filter(room => !start.includes(room));\n\n\t\tlet abbr = roomList.filter(room =>\n\t\t\ttoID(room.title.toLowerCase().replace(/\\b([a-z0-9])[a-z0-9]*\\b/g, '$1')).startsWith(searchid) ||\n\t\t\troom.title.replace(/[^A-Z0-9]+/g, '').toLowerCase().startsWith(searchid)\n\t\t);\n\n\t\tconst hidden = !exactMatch ? [{title: this.search, desc: \"(Private room?)\"}] : [];\n\n\t\tconst autoFill = this.lastKeyCode !== 127 && this.lastKeyCode >= 32;\n\t\tif (autoFill) {\n\t\t\tconst firstTitle = (start[0] || abbr[0] || hidden[0]).title;\n\t\t\tlet firstTitleOffset = 0;\n\t\t\twhile (\n\t\t\t\tsearchid !== toID(firstTitle.slice(0, firstTitleOffset)) &&\n\t\t\t\tfirstTitleOffset < firstTitle.length // should never happen, but sanity against infinite loop\n\t\t\t) {\n\t\t\t\tfirstTitleOffset++;\n\t\t\t}\n\t\t\tlet autoFillValue = firstTitle.slice(firstTitleOffset);\n\t\t\tif (!autoFillValue && toID(firstTitle) !== searchid) {\n\t\t\t\tautoFillValue = ' \\u21d2 ' + firstTitle;\n\t\t\t}\n\t\t\tconst oldSearch = this.search;\n\t\t\tconst searchElem = this.base!.querySelector('input[type=search]') as HTMLInputElement;\n\t\t\tsearchElem.value = oldSearch + autoFillValue;\n\t\t\tsearchElem.setSelectionRange(oldSearch.length, oldSearch.length + autoFillValue.length);\n\t\t}\n\n\t\treturn {start, abbr, hidden};\n\t}\n\tfocus() {\n\t\t(this.base!.querySelector('input[type=search]') as HTMLInputElement).focus();\n\t}\n\trender() {\n\t\tif (this.hidden && PS.isVisible(this.props.room)) this.hidden = false;\n\t\tif (this.hidden) {\n\t\t\treturn <PSPanelWrapper room={this.props.room} scrollable>{null}</PSPanelWrapper>;\n\t\t}\n\t\tconst rooms = PS.mainmenu.roomsCache;\n\n\t\tlet roomList;\n\t\tif (this.search) {\n\t\t\tconst search = this.runSearch();\n\t\t\troomList = [\n\t\t\t\tthis.renderRoomList(\"Search results\", search.start),\n\t\t\t\tthis.renderRoomList(\"Search results (acronym)\", search.abbr),\n\t\t\t\tthis.renderRoomList(\"Possible hidden room\", search.hidden),\n\t\t\t];\n\t\t} else {\n\t\t\troomList = [\n\t\t\t\tthis.renderRoomList(\"Chat rooms\", rooms.chat),\n\t\t\t];\n\t\t}\n\n\t\treturn <PSPanelWrapper room={this.props.room} scrollable><div class=\"pad\">\n\t\t\t<button class=\"button\" style=\"float:right;font-size:10pt;margin-top:3px\" onClick={this.hide}>\n\t\t\t\t<i class=\"fa fa-caret-right\"></i> Hide\n\t\t\t</button>\n\t\t\t<div class=\"roomcounters\">\n\t\t\t\t<button class=\"button\" data-href=\"/users\" title=\"Find an online user\">\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"pixelated usercount\"\n\t\t\t\t\t\ttitle=\"Meloetta is PS's mascot! The Aria forme is about using its voice, and represents our chatrooms.\"\n\t\t\t\t\t></span>\n\t\t\t\t\t<strong>{rooms.userCount || '-'}</strong> users online\n\t\t\t\t</button> {}\n\t\t\t\t<button class=\"button\" data-href=\"/battles\" title=\"Watch an active battle\">\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"pixelated battlecount\"\n\t\t\t\t\t\ttitle=\"Meloetta is PS's mascot! The Pirouette forme is Fighting-type, and represents our battles.\"\n\t\t\t\t\t></span>\n\t\t\t\t\t<strong>{rooms.battleCount || '-'}</strong> active battles\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<input\n\t\t\t\t\ttype=\"search\" name=\"roomsearch\" class=\"textbox\" style=\"width: 100%; max-width: 480px\"\n\t\t\t\t\tplaceholder=\"Join or search for rooms\"\n\t\t\t\t\tonInput={this.changeSearch} onKeyDown={this.keyDownSearch}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t{PS.isOffline ? <h2>(offline)</h2> : rooms.userCount === undefined && <h2>Connecting...</h2>}\n\t\t\t{roomList}\n\t\t</div></PSPanelWrapper>;\n\t}\n\trenderRoomList(title: string, rooms?: RoomInfo[]) {\n\t\tif (!rooms || !rooms.length) return null;\n\t\t// Descending order\n\t\tconst sortedRooms = rooms.sort((a, b) => (b.userCount || 0) - (a.userCount || 0));\n\t\treturn <div class=\"roomlist\">\n\t\t\t<h2>{title}</h2>\n\t\t\t{sortedRooms.map(roomInfo => <div>\n\t\t\t\t<a href={`/${toID(roomInfo.title)}`} class=\"blocklink\">\n\t\t\t\t\t{roomInfo.userCount !== undefined && <small style=\"float:right\">({roomInfo.userCount} users)</small>}\n\t\t\t\t\t<strong><i class=\"fa fa-comment-o\"></i> {roomInfo.title}<br /></strong>\n\t\t\t\t\t<small>{roomInfo.desc || ''}</small>\n\t\t\t\t\t{roomInfo.subRooms && <small><br />\n\t\t\t\t\t\t<i class=\"fa fa-level-up fa-rotate-90\"></i> Subrooms: <strong>\n\t\t\t\t\t\t\t{roomInfo.subRooms.map((roomName, i) => [\n\t\t\t\t\t\t\t\t<i class=\"fa fa-comment-o\"></i>, \" \" + roomName + (i === roomInfo.subRooms!.length - 1 ? \"\" : \", \"),\n\t\t\t\t\t\t\t])}\n\t\t\t\t\t\t</strong>\n\t\t\t\t\t</small>}\n\t\t\t\t</a>\n\t\t\t</div>)}\n\t\t</div>;\n\t}\n}\n\nPS.roomTypes['rooms'] = {\n\tModel: RoomsRoom,\n\tComponent: RoomsPanel,\n};\nPS.updateRoomTypes();\n"],"mappings":"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"}